!function(a){function b(a){return.000621371192*a}function c(a,b,c,d,e,f){a.geocode({address:c},function(a,c){if(c===google.maps.GeocoderStatus.OK){b.setCenter(a[0].geometry.location);var d=new google.maps.Marker({map:b,position:a[0].geometry.location,label:""});d.addListener("click",e),d.addListener("dblclick",f),e()}})}function d(a,b,c){"undefined"==typeof c&&(c="DRIVING");var d={destination:b,origin:a,travelMode:google.maps.TravelMode[c],unitSystem:google.maps.UnitSystem.IMPERIAL};r.route(d,function(a,b){b==google.maps.DirectionsStatus.OK&&s.setDirections(a)})}function e(){a(".wmf-academy-locator .wr-element-text ol li").sort(function(b,c){return parseInt(a(b).attr("data-addressDistance"),10)>parseInt(a(c).attr("data-addressDistance"),10)}).appendTo(".wmf-academy-locator .wr-element-text ol"),a(".wmf-academy-locator .wr-element-text ol li:first").click(),a(".distant .wr-element-text ol li").sort(function(b,c){return parseInt(a(b).attr("data-addressDistance"),10)>parseInt(a(c).attr("data-addressDistance"),10)}).appendTo(".distant .wr-element-text ol"),a(".distant .wr-element-text ol li:first").click()}function f(c,d,f,g,h){f=f?f:k,q.getDistanceMatrix({origins:[d],destinations:f,travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL,avoidHighways:!1,avoidTolls:!1},function(c,d){if(d===google.maps.DistanceMatrixStatus.OK){var f=c.rows[0].elements;wmf_locations_dis=new Array;for(var i=0;i<f.length;i++)a(".wmf-academy-locator .wr-element-text ol li").each(function(){a(this).attr("data-addressIndex")==wmf_locations_dis.length&&("undefined"!==a.type(f[i].distance)?(a(this).find(".distance-matrix").html(parseFloat(b(f[i].distance.value)).toFixed(1)+" miles"),a(this).attr("data-addressDistance",f[i].distance.value)):a(this).find(".distance-matrix").html(""))}),a(".distant .wr-element-text ol li").each(function(){a(this).attr("data-addressIndex")==wmf_locations_dis.length&&("undefined"!==a.type(f[i].distance)?(a(this).attr("data-addressDistance",f[i].distance.value),a(this).show(),g>0&&parseInt(a(this).attr("data-addressDistance"),10)>g&&a(this).hide()):a(this).show())}),"undefined"!==a.type(f[i].distance)?(wmf_locations_dis.push(new Array(f[i].distance.value,wmf_locations_dis.length)),wmf_locations_dis=wmf_locations_dis.sort(function(a,b){return a[0]>b[0]})):wmf_locations_dis.push(new Array(0,wmf_locations_dis.length));e(),"function"==typeof h&&h()}})}function g(a,b,c,d,e){a&&(a[0]?b=a[0].formatted_address:a[1]&&(b=a[1].formatted_address)),f(a,b,c,d,e)}function h(b,c,d,e,f,h){var j={};"string"==a.type(d)?j.address=d:j.location=d,j&&b.geocode(j,function(a,j){j===google.maps.GeocoderStatus.OK&&(d=a[0].formatted_address),i(b,c,d),g(a,d,e,f,h)})}function i(b,c,d){var e={};"string"==a.type(d)?e.address=d:e.location=d,e&&b.geocode(e,function(a,b){b===google.maps.GeocoderStatus.OK&&(c.setCenter(a[0].geometry.location),m.setZoom(n))})}function j(a){a=a.replace(/\s/g,"");var b=/^[A-Z]{1,2}[0-9]{1,2} ?[0-9][A-Z]{2}$/i;return b.test(a)}var k=new Array,l="",m=null,n=12,o=new google.maps.LatLng(51.56512,-.154495),p=new google.maps.Geocoder,q=new google.maps.DistanceMatrixService,r=new google.maps.DirectionsService,s=new google.maps.DirectionsRenderer({map:m}),t="map-google-directions",u="none_gmap",v={zoom:n,center:o,mapTypeId:google.maps.MapTypeId.ROADMAP,streetViewControl:!0,zoomControl:!0,panControl:!0,mapTypeControl:!0,scaleControl:!0,overviewMapControl:!0,scrollwheel:!1};wmf_locations&&a(document).ready(function(){a(window).load(function(){l=a("#map_locator").children("div").children("div").attr("id"),l||(l=a("#"+t).parent().children("div").attr("id")),l||(l=u,a("body").append(a("<div>").attr("id",l).hide())),m=new google.maps.Map(document.getElementById(l),v),s=new google.maps.DirectionsRenderer({map:m}),a(".wmf-academy-locator .wr-element-text ol").html(""),a(".distant .wr-element-text ol").html(""),a.each(wmf_locations,function(b,e){var f=e.address.replace(/[-]+/g," ");if(f=f.replace(/[\n\r]/g," "),f=f.replace(/[ ]+/g," "),k.push(f),l==t){var g=blogAddress,h=blogAddress;return postcodeVal&&(h=postcodeVal),void d(h,g)}var i=e.name,j=e.address.split(",").join(",<br>"),n=a("<li>").attr("data-address",f).attr("data-url",e.url).attr("data-coaching-url",e.coaching_url).attr("data-birthday-url",e.birthday_url).attr("data-additonal-info",e.additonal_info).attr("data-session-times",e.session_times).attr("data-addressIndex",b).append("<h2>"+i+"</h2>").append('<p class="distance-matrix">3.6m</p>').append("<span>"+j+"</span>");a(".wmf-academy-locator .wr-element-text ol").append(n);var o=a("<li>").attr("data-address",f).attr("data-url",e.url).attr("data-coaching-url",e.coaching_url).attr("data-birthday-url",e.birthday_url).attr("data-additonal-info",e.additonal_info).attr("data-session-times",e.session_times).attr("data-addressIndex",b).append("<a>"+i+"</a>");a(".distant .wr-element-text ol").append(o),c(p,m,f,b+1,function(){n.click(),o.click()},function(){n.dblclick(),o.dblclick()})})})}).ready(function(){a(window).load(function(){o=k[0],postcodeVal&&(o=postcodeVal),h(p,m,o,k,0)})}).on("click",".wmf-academy-locator .wr-element-text ol li",function(){a(".wmf-academy-locator .wr-element-text ol li.active").removeClass("active"),a(this).addClass("active"),i(p,m,a(this).attr("data-address"))}).on("click",".wmf-academy-locator .wr-element-text ol li",function(){var b=a("h2",a(this)).html();a(".address-info .wr_text ul li h2").html(b);var c=a(".distance-matrix",a(this)).html(),d=a("span",a(this)).html(),e="<span>"+c+"</span><br>"+d;a(".address-info .wr_text ul li p:first").html(e);var f=a(this).index();document.styleSheets[0].addRule(".address-info .wr_text ul li:before","content: attr(data-before-index) !important;"),a(".address-info .wr_text ul li").attr("data-before-index",f+1);var g=a(this).attr("data-additonal-info");a(".address-info .wr_text ul li h4 + p").html(g);var h=a(this).attr("data-session-times");a(".session-time .wr_text table").html(h);var i=a(this).attr("data-url");a(".wmf-academy-locator .entry-content .address-academy-locator .session-time div p>a").attr("href",i);var j=a(".wmf-academy-locator .entry-content .address-academy-locator .session-time.col-sm-6 .wr_text").height()+30;a(".wmf-academy-locator .entry-content .address-academy-locator .session-time.col-sm-6").outerHeight(j),a(".wmf-academy-locator .entry-content .address-academy-locator .address-info").outerHeight(j)}).ready(function(){var b='<div id="wrapper" style="position:relative;"><div id="floating-panel" style="position: absolute; top: 10px; left: 25%; z-index: 5; background-color: #fff; padding: 5px; border: 1px solid #999; text-align: center; line-height: 30px; padding-left: 10px;"><b>Mode of Travel: </b><select id="mode"><option value="DRIVING">Driving</option><option value="WALKING">Walking</option><option value="BICYCLING">Bicycling</option><option value="TRANSIT">Transit</option></select></div>';a(".wmf-google-directions > .page").prepend(b),a(window).load(function(){a(".wmf-academy-locator .entry-content .address-academy-locator .session-time div p>a").html("go to this academy")})}).on("click",".wmf-academy-locator .wr-element-text ol li",function(){}).on("click",".distant .wr-element-text ol li",function(){a(".distant .wr-element-text ol li a.active").removeClass("active"),a(this).find("a").addClass("active"),i(p,m,a(this).attr("data-address"))}).on("dblclick",".distant .wr-element-text ol li",function(){_param="","undefined"!=a.type(is_birthday_parties)&&"true"==is_birthday_parties?"false"!=a(this).attr("data-birthday-url")&&(_param="?p="+a(this).attr("data-birthday-url")):"undefined"!=a.type(is_121_coaching)&&"true"==is_121_coaching&&"false"!=a(this).attr("data-coaching-url")&&(_param="?p="+a(this).attr("data-coaching-url")),window.open(a(this).attr("data-url")+_param,"_blank")}).on("touchstart",".distant .wr-element-text ol li",function(b){var c,d=(new Date).getTime(),e=a(this).attr("data-lastTouch")||d+1,f=d-e;f>600||1>f?c=setTimeout(function(){a(this).attr("data-lastTouch",d+1),a(this).click()},600):(clearTimeout(c),window.location=a(this).attr("data-url")),b.preventDefault()}).ready(function(){a(window).load(function(){a("#search--an-academy-locator").val(postcodeVal)}),a(window).load(function(){if(a("#search--an-academy-locator").length>0&&a("#search--an-academy-locator").val().length>0){var b=jQuery.Event("keypress");b.which=13,a("#search--an-academy-locator").trigger(b),event.preventDefault()}})}).on("click","#search--an-academy-locator + a, #search--an-academy-locator ~ .search-locator-postcode, [data-type=postcode] + a, [type=postcode] + a, [type=postcode] ~ .btn-find-locator, [data-type=postcode] ~ .btn-find-locator, [type=postcode] ~ .btn-find-near, [data-type=postcode] ~ .btn-find-near",function(b){var c=jQuery.Event("keypress");c.which=13,a("[data-type=postcode], [type=postcode], #search--an-academy, #search--an-academy-locator",a(this).parent()).trigger(c),b.preventDefault()}).on("click keypress","[data-type=postcode], [data-type=poscode], [type=postcode], [type=poscode], #search--an-academy, #search--an-academy-locator",function(b){if(a(this).autocomplete({source:function(){var b=new Array;return a.each(wmf_locations_dis.sort(function(a,b){return a[0]>b[0]}),function(a,c){b.push(wmf_locations[c[1]])}),b}(),select:function(b,c){if(c&&"underfined"!=typeof c.item){a(this).val(c.item.label);var e=a(this).val();if(e=j(e),0==e)return alert("Please enter a valid postcode"),!1;if("Start point"==a(this).attr("placeholder")){var f=a(".active",a(".wmf-academy-locator .wr-element-text ol")).attr("data-address"),g=f;a("#search--an-academy-locator",a(this).parents(".wmf-col")).val()&&(g=a("#search--an-academy-locator",a(this).parents(".wmf-col")).val()),a(this).val()&&(g=a(this).val()),d(g,f)}else if(a(this).hasClass("input-postcode-find")){var l=0;a(".within-radius",a(this).parent()).val()&&(l=a(".within-radius",a(this).parent()).val()),h(p,m,a(this).val(),k,l,function(){wmf_locations_dis.length>0&&(i(p,m,wmf_locations[wmf_locations_dis[0][1]].label),m.setZoom(n))})}else if(a(this).is("#search--an-academy-locator")){h(p,m,a(this).val(),k);var f=a(".active",a(".wmf-academy-locator .wr-element-text ol")).attr("data-address"),g=f;a(this).val()&&(g=a(this).val()),a("#search--an-academy-locator",a(this).parents(".wmf-col")).val()&&(g=a("#search--an-academy-locator",a(this).parents(".wmf-col")).val()),d(g,f)}else if(a(this).is(".input-postcode-site, .input-postcode-site-2, [type=poscode]")){var o=blogUrl+"/google-directions/",q="<form method='POST' action='"+o+"' target='_blank'>\n";q+="<input type='hidden' name='postcode' value='"+a(this).val()+"'></input></form>";var r=a(q);a("body").append(r),a(r).submit()}else{var o=wmf_main_url+"/academy-locator/",q="<form method='POST' action='"+o+"'>\n";q+="<input type='hidden' name='postcode' value='"+a(this).val()+"'></input></form>";var r=a(q);a("body").append(r),a(r).submit()}}return!1}}),13==b.which){var c=a(this).val();if(c=j(c),"Start point"==a(this).attr("placeholder")){var e=a(".active",a(".wmf-academy-locator .wr-element-text ol")).attr("data-address"),f=e;a("#search--an-academy-locator",a(this).parents(".wmf-col")).val()&&(f=a("#search--an-academy-locator",a(this).parents(".wmf-col")).val()),a(this).val()&&(f=a(this).val()),d(f,e)}else{if(0==c)return alert("Please enter a valid postcode"),!1;if(a(this).hasClass("input-postcode-find")){var g=0;a(".within-radius",a(this).parent()).val()&&(g=a(".within-radius",a(this).parent()).val()),h(p,m,a(this).val(),k,g,function(){wmf_locations_dis.length>0&&(i(p,m,wmf_locations[wmf_locations_dis[0][1]].label),m.setZoom(n))})}else if(a(this).is("#search--an-academy-locator")){h(p,m,a(this).val(),k);var e=a(".active",a(".wmf-academy-locator .wr-element-text ol")).attr("data-address"),f=e;a(this).val()&&(f=a(this).val()),a("#search--an-academy-locator",a(this).parents(".wmf-col")).val()&&(f=a("#search--an-academy-locator",a(this).parents(".wmf-col")).val()),d(f,e)}else if(a(this).is(".input-postcode-site, .input-postcode-site-2, [type=poscode]")){var l=blogUrl+"/google-directions/",o="<form method='POST' action='"+l+"' target='_newtab'>\n";o+="<input type='hidden' name='postcode' value='"+a(this).val()+"'></input></form>";var q=a(o);a("body").append(q),a(q).submit()}else{var l=wmf_main_url+"/academy-locator/",o="<form method='POST' action='"+l+"'>\n";o+="<input type='hidden' name='postcode' value='"+a(this).val()+"'></input></form>";var q=a(o);a("body").append(q),a(q).submit()}}}}).on("change","#mode",function(b){var c=a("#mode").val(),e=blogAddress,f=blogAddress;postcodeVal&&(f=postcodeVal),d(f,e,c)})}(jQuery);